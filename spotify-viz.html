<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Pulse of Music | Mehul Parashar</title>
    
    <!-- D3.js Library -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    
    <style>
        /* --- Variables & Theme --- */
        :root {
            --bg-core: #050505;
            --bg-card: #0f0f0f;
            --bg-glass: rgba(20, 20, 20, 0.6);
            --gold-accent: #D4AF37;
            --text-primary: #F0F0F0;
            --text-secondary: #888888;
            --border-subtle: rgba(212, 175, 55, 0.15);
            --font-serif: 'Playfair Display', serif;
            --font-sans: 'Manrope', sans-serif;
            
            /* Data Colors */
            --spotify: #1DB954;
            --explicit-red: #e91e63;
            --clean-blue: #2196f3;
            --chart-grad-1: #D4AF37;
            --chart-grad-2: #8a732d;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            background-color: var(--bg-core);
            color: var(--text-primary);
            font-family: var(--font-sans);
            line-height: 1.8;
            overflow-x: hidden;
        }

        /* Grain Texture */
        .grain-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
            pointer-events: none; z-index: 9999;
        }

        /* --- Navigation --- */
        nav {
            position: fixed; top: 0; width: 100%; z-index: 1000; padding: 20px 0;
            background: rgba(5, 5, 5, 0.9); backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.03);
        }
        .nav-container { display: flex; justify-content: space-between; max-width: 1200px; margin: 0 auto; padding: 0 2rem; align-items: center; }
        .back-btn { color: var(--text-secondary); text-decoration: none; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 1.5px; transition: 0.3s; border-bottom: 1px solid transparent; }
        .back-btn:hover { color: var(--gold-accent); border-bottom-color: var(--gold-accent); }
        .logo { font-family: var(--font-serif); color: var(--text-primary); font-size: 1.2rem; letter-spacing: -0.5px; }

        /* --- Layout & Typography --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 2rem; position: relative; z-index: 1; }
        
        .section-viz { 
            padding: 120px 0; 
            border-bottom: 1px solid rgba(255,255,255,0.03); 
            min-height: 100vh; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
        }
        
        h1 { font-family: var(--font-serif); font-size: clamp(3rem, 6vw, 6rem); line-height: 1; letter-spacing: -0.03em; margin-bottom: 30px; }
        h2 { font-family: var(--font-serif); font-size: 3rem; color: var(--text-primary); margin-bottom: 10px; }
        h3 { font-family: var(--font-sans); font-size: 0.9rem; text-transform: uppercase; letter-spacing: 3px; color: var(--gold-accent); margin-bottom: 20px; display: block;}
        p { max-width: 650px; color: var(--text-secondary); font-size: 1.1rem; font-weight: 300; margin-bottom: 40px; }
        
        /* --- KPI Strip --- */
        .kpi-strip {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin: 60px 0;
            padding: 30px;
            background: var(--bg-glass);
            border: 1px solid var(--border-subtle);
            backdrop-filter: blur(10px);
        }
        .kpi-item h4 { font-family: var(--font-sans); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1.5px; color: var(--text-secondary); margin-bottom: 10px; }
        .kpi-item .value { font-family: var(--font-serif); font-size: 2.5rem; color: var(--gold-accent); line-height: 1; }

        /* --- Chart Containers --- */
        .chart-wrapper {
            width: 100%;
            height: 650px;
            background: radial-gradient(circle at center, #111 0%, #050505 100%);
            border: 1px solid var(--border-subtle);
            position: relative;
            overflow: hidden;
        }
        
        /* Specific chart styling */
        .chart-full { grid-column: span 2; }

        /* D3 Tooltip */
        .tooltip {
            position: absolute;
            text-align: center;
            padding: 15px;
            background: rgba(10, 10, 10, 0.95);
            border: 1px solid var(--gold-accent);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            font-family: var(--font-sans);
            font-size: 0.85rem;
            color: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            z-index: 100;
            min-width: 150px;
        }
        .tooltip strong { display: block; font-family: var(--font-serif); font-size: 1rem; margin-bottom: 5px; color: var(--gold-accent); }

        /* Legend */
        .legend { display: flex; gap: 20px; margin-bottom: 20px; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; color: var(--text-secondary); }
        .legend-item { display: flex; align-items: center; gap: 8px; }
        .dot { width: 10px; height: 10px; border-radius: 50%; }

    </style>
</head>
<body>

    <div class="grain-overlay"></div>

    <nav>
        <div class="nav-container">
            <a href="index.html" class="back-btn">‚Üê Return to Dossier</a>
            <div class="logo">MP <span style="color:var(--gold-accent)">/</span> Data</div>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <section class="section-viz" style="min-height: 80vh; padding-top: 150px;">
        <div class="container">
            <span style="color: var(--gold-accent); text-transform: uppercase; letter-spacing: 4px; font-size: 0.8rem; border-left: 1px solid var(--gold-accent); padding-left: 15px; margin-bottom: 20px; display: block;">Interactive Case Study</span>
            <h1>The Pulse of Music.</h1>
            <p>A data-driven investigation into the sonic architecture of modern hits. Analyzing 2,000+ tracks to decode the impact of censorship, the attention economy, and genre evolution.</p>
            
            <!-- KPI DASHBOARD -->
            <div class="kpi-strip">
                <div class="kpi-item">
                    <h4>Total Tracks</h4>
                    <div class="value" id="kpi-tracks">-</div>
                </div>
                <div class="kpi-item">
                    <h4>Avg Duration</h4>
                    <div class="value" id="kpi-duration">-</div>
                </div>
                <div class="kpi-item">
                    <h4>Explicit %</h4>
                    <div class="value" id="kpi-explicit">-</div>
                </div>
                <div class="kpi-item">
                    <h4>Artist Reach</h4>
                    <div class="value" id="kpi-followers">-</div>
                </div>
            </div>
            
            <p style="font-size: 0.8rem; opacity: 0.5; margin-top: -20px;">*Data sourced from Spotify Web API (2025 Snapshot)</p>
        </div>
    </section>

    <!-- VIZ 1: TREEMAP (THE TITANS) -->
    <section class="section-viz">
        <div class="container">
            <h3>01. Market Dominance</h3>
            <h2>The Titans of Streaming</h2>
            <p>Visualizing artist market share by follower count. The size of the block represents total reach, while the color intensity indicates current popularity momentum.</p>
            <div id="viz-treemap" class="chart-wrapper"></div>
        </div>
    </section>

    <!-- VIZ 2: LINE CHART (ATTENTION ECONOMY) -->
    <section class="section-viz">
        <div class="container">
            <h3>02. The Attention Economy</h3>
            <h2>Are Songs Getting Shorter?</h2>
            <p>Tracking the average song duration over time. As streaming models reward skip-rate optimization, we observe the "TikTok Effect" on song structure.</p>
            <div id="viz-line" class="chart-wrapper"></div>
        </div>
    </section>

    <!-- VIZ 3: RADIAL (HIT ARCHITECTURE) -->
    <section class="section-viz">
        <div class="container">
            <h3>03. Sonic Fingerprint</h3>
            <h2>Album Hit Architecture</h2>
            <p>A radial breakdown of the dataset's top album. Each slice is a track; length is duration, brightness is popularity. Observe the "drop-off" after the first 3 singles.</p>
            <div id="viz-radial" class="chart-wrapper"></div>
            <div class="legend" style="margin-top: 15px;">
                <div class="legend-item">Currently Viewing: <span id="album-name" style="color:white; margin-left: 5px;">Loading...</span></div>
            </div>
        </div>
    </section>

    <!-- VIZ 4: BEESWARM (EXPLICIT CONTENT) -->
    <section class="section-viz">
        <div class="container">
            <h3>04. Content Analysis</h3>
            <h2>The Explicit Divide</h2>
            <p>Does profanity pay? A gravity simulation plotting tracks by Release Date vs. Artist Popularity. Red indicates explicit content.</p>
            <div class="legend">
                <div class="legend-item"><div class="dot" style="background:var(--explicit-red)"></div> Explicit</div>
                <div class="legend-item"><div class="dot" style="background:var(--clean-blue)"></div> Clean</div>
            </div>
            <div id="viz-beeswarm" class="chart-wrapper"></div>
        </div>
    </section>

    <!-- VIZ 5: STREAMGRAPH (GENRE EVOLUTION) -->
    <section class="section-viz">
        <div class="container">
            <h3>05. Macro Trends</h3>
            <h2>The Flow of Genre</h2>
            <p>A streamgraph tracing the rise and fall of dominant musical styles over the years within the dataset.</p>
            <div id="viz-stream" class="chart-wrapper"></div>
        </div>
    </section>

    <!-- Tooltip Div -->
    <div id="tooltip" class="tooltip"></div>

    <script>
        // --- CONFIG ---
        const DATA_URL = "./data/spotify_data_clean.csv";
        const width = 1100;
        const height = 650;
        const tooltip = d3.select("#tooltip");

        // --- LOAD DATA ---
        d3.csv(DATA_URL).then(data => {
            
            // Data Cleaning
            data.forEach(d => {
                d.track_popularity = +d.track_popularity;
                d.track_duration_min = +d.track_duration_min;
                d.artist_popularity = +d.artist_popularity;
                d.artist_followers = +d.artist_followers;
                d.album_release_date = new Date(d.album_release_date);
                d.year = d.album_release_date.getFullYear();
                d.explicit = (d.explicit === 'TRUE' || d.explicit === true);
            });

            // --- RENDER KPIS ---
            renderKPIs(data);

            // --- RENDER CHARTS ---
            drawTreemap(data);
            drawLineChart(data);
            drawRadial(data);
            drawBeeswarm(data);
            drawStreamgraph(data);

        }).catch(err => {
            console.error(err);
            document.querySelector('.kpi-strip').innerHTML = `<p style='color:red'>Error loading data. Please ensure data is in /data/spotify_data_clean.csv</p>`;
        });

        // --- KPI LOGIC ---
        function renderKPIs(data) {
            // 1. Total Tracks
            d3.select("#kpi-tracks").text(data.length.toLocaleString());

            // 2. Avg Duration
            const avgDur = d3.mean(data, d => d.track_duration_min);
            d3.select("#kpi-duration").text(avgDur.toFixed(2) + "m");

            // 3. Explicit %
            const explicitCount = data.filter(d => d.explicit).length;
            const explicitPct = (explicitCount / data.length) * 100;
            d3.select("#kpi-explicit").text(explicitPct.toFixed(1) + "%");

            // 4. Total Artist Reach (Unique Artists)
            const uniqueArtists = new Map();
            data.forEach(d => {
                if(!uniqueArtists.has(d.artist_name)) {
                    uniqueArtists.set(d.artist_name, d.artist_followers);
                }
            });
            let totalReach = 0;
            uniqueArtists.forEach(v => totalReach += v);
            
            // Format M/B
            const formatReach = (num) => {
                if(num > 1000000000) return (num/1000000000).toFixed(1) + "B";
                if(num > 1000000) return (num/1000000).toFixed(1) + "M";
                return num.toLocaleString();
            };
            d3.select("#kpi-followers").text(formatReach(totalReach));
        }

        // --- 1. TREEMAP (THE TITANS) ---
        function drawTreemap(data) {
            const container = d3.select("#viz-treemap");
            const svg = container.append("svg")
                .attr("viewBox", [0, 0, width, height])
                .attr("width", "100%")
                .attr("height", "100%");

            // Group by Artist, get Max Followers (since it repeats) and Mean Popularity
            const artistData = d3.rollup(data, v => ({
                followers: d3.max(v, d => d.artist_followers),
                popularity: d3.mean(v, d => d.artist_popularity),
                topTrack: v.sort((a,b) => b.track_popularity - a.track_popularity)[0].track_name
            }), d => d.artist_name);

            // Convert to Hierarchy
            const root = d3.hierarchy({ children: Array.from(artistData, ([key, value]) => ({ name: key, ...value })) })
                .sum(d => d.followers)
                .sort((a, b) => b.value - a.value);

            d3.treemap()
                .size([width, height])
                .padding(2)
                (root);

            // Color Scale (Gold Gradient based on Popularity)
            const color = d3.scaleLinear()
                .domain([0, 100])
                .range(["#1a1a1a", "#D4AF37"]);

            const leaf = svg.selectAll("g")
                .data(root.leaves())
                .join("g")
                .attr("transform", d => `translate(${d.x0},${d.y0})`);

            leaf.append("rect")
                .attr("width", d => d.x1 - d.x0)
                .attr("height", d => d.y1 - d.y0)
                .attr("fill", d => color(d.data.popularity))
                .attr("stroke", "#050505")
                .on("mouseover", function(event, d) {
                    d3.select(this).attr("stroke", "#fff").attr("stroke-width", 2);
                    tooltip.style("opacity", 1)
                        .html(`<strong>${d.data.name}</strong>Top Track: ${d.data.topTrack}<br>Followers: ${(d.data.followers/1000000).toFixed(1)}M`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    d3.select(this).attr("stroke", "#050505").attr("stroke-width", 1);
                    tooltip.style("opacity", 0);
                });

            // Text Labels (Only for big boxes)
            leaf.append("text")
                .selectAll("tspan")
                .data(d => d.x1 - d.x0 > 50 && d.y1 - d.y0 > 30 ? [d.data.name] : []) 
                .join("tspan")
                .attr("x", 5)
                .attr("y", 15)
                .text(d => d)
                .attr("font-size", "0.7rem")
                .attr("fill", "white")
                .style("pointer-events", "none");
        }

        // --- 2. LINE CHART (ATTENTION ECONOMY) ---
        function drawLineChart(data) {
            const container = d3.select("#viz-line");
            const svg = container.append("svg")
                .attr("viewBox", [0, 0, width, height])
                .attr("width", "100%")
                .attr("height", "100%");

            const margin = {top: 40, right: 40, bottom: 40, left: 50};

            // Group by Year -> Avg Duration
            const trends = Array.from(d3.rollup(data, v => d3.mean(v, d => d.track_duration_min), d => d.year))
                .map(([year, dur]) => ({ year: new Date(year, 0, 1), duration: dur }))
                .sort((a,b) => a.year - b.year);

            const x = d3.scaleTime()
                .domain(d3.extent(trends, d => d.year))
                .range([margin.left, width - margin.right]);

            const y = d3.scaleLinear()
                .domain([d3.min(trends, d => d.duration) - 0.2, d3.max(trends, d => d.duration) + 0.2])
                .range([height - margin.bottom, margin.top]);

            // Line Generator
            const line = d3.line()
                .curve(d3.curveMonotoneX)
                .x(d => x(d.year))
                .y(d => y(d.duration));

            // Gradient Area
            const area = d3.area()
                .curve(d3.curveMonotoneX)
                .x(d => x(d.year))
                .y0(height - margin.bottom)
                .y1(d => y(d.duration));

            const defs = svg.append("defs");
            const gradient = defs.append("linearGradient")
                .attr("id", "line-gradient")
                .attr("x1", "0%").attr("y1", "0%").attr("x2", "0%").attr("y2", "100%");
            gradient.append("stop").attr("offset", "0%").attr("stop-color", "#D4AF37").attr("stop-opacity", 0.4);
            gradient.append("stop").attr("offset", "100%").attr("stop-color", "#D4AF37").attr("stop-opacity", 0);

            // Draw Area
            svg.append("path")
                .datum(trends)
                .attr("fill", "url(#line-gradient)")
                .attr("d", area);

            // Draw Line
            svg.append("path")
                .datum(trends)
                .attr("fill", "none")
                .attr("stroke", "#D4AF37")
                .attr("stroke-width", 3)
                .attr("d", line);

            // Draw Dots
            svg.selectAll("circle")
                .data(trends)
                .join("circle")
                .attr("cx", d => x(d.year))
                .attr("cy", d => y(d.duration))
                .attr("r", 4)
                .attr("fill", "#fff")
                .on("mouseover", (event, d) => {
                     tooltip.style("opacity", 1)
                        .html(`<strong>Year: ${d.year.getFullYear()}</strong>Avg Duration: ${d.duration.toFixed(2)} min`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", () => tooltip.style("opacity", 0));

            // Axes
            svg.append("g")
                .attr("transform", `translate(0,${height - margin.bottom})`)
                .call(d3.axisBottom(x).ticks(10));
            
            svg.append("g")
                .attr("transform", `translate(${margin.left},0)`)
                .call(d3.axisLeft(y).ticks(5).tickFormat(d => d + "m"));
        }

        // --- 3. RADIAL CHART ---
        function drawRadial(data) {
            const container = d3.select("#viz-radial");
            const svg = container.append("svg")
                .attr("viewBox", [-width / 2, -height / 2, width, height])
                .attr("width", "100%")
                .attr("height", "100%");

            const albums = d3.rollup(data, v => ({
                totalPop: d3.sum(v, d => d.track_popularity),
                tracks: v.sort((a, b) => a.track_number - b.track_number),
                artist: v[0].artist_name,
                name: v[0].album_name
            }), d => d.album_name);

            const sortedAlbums = Array.from(albums).sort((a, b) => b[1].totalPop - a[1].totalPop);
            const topAlbum = sortedAlbums[0][1]; 
            document.getElementById('album-name').innerText = `${topAlbum.name} by ${topAlbum.artist}`;

            const tracks = topAlbum.tracks;
            const innerRadius = 120;
            const outerRadius = 280;

            const x = d3.scaleBand()
                .range([0, 2 * Math.PI])
                .align(0)
                .domain(tracks.map(d => d.track_name));

            const y = d3.scaleLinear()
                .range([innerRadius, outerRadius])
                .domain([0, d3.max(tracks, d => d.track_duration_min)]);

            const color = d3.scaleLinear()
                .domain([0, 100])
                .range(["#333", "#1DB954"]);

            svg.append("g")
                .selectAll("path")
                .data(tracks)
                .join("path")
                .attr("fill", d => color(d.track_popularity))
                .attr("d", d3.arc()
                    .innerRadius(innerRadius)
                    .outerRadius(d => y(d.track_duration_min))
                    .startAngle(d => x(d.track_name))
                    .endAngle(d => x(d.track_name) + x.bandwidth())
                    .padAngle(0.02)
                    .padRadius(innerRadius))
                .on("mouseover", function(event, d) {
                    d3.select(this).attr("fill", "#D4AF37");
                    tooltip.style("opacity", 1)
                        .html(`<strong>${d.track_name}</strong>Pop: ${d.track_popularity}<br>Length: ${d.track_duration_min}m`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function(event, d) {
                    d3.select(this).attr("fill", color(d.track_popularity));
                    tooltip.style("opacity", 0);
                });
        }

        // --- 4. BEESWARM (EXPLICIT) ---
        function drawBeeswarm(data) {
            const container = d3.select("#viz-beeswarm");
            const sample = data.sort((a,b) => b.track_popularity - a.track_popularity).slice(0, 350);
            const svg = container.append("svg").attr("viewBox", [0, 0, width, height]);

            const x = d3.scaleTime().domain(d3.extent(sample, d => d.album_release_date)).range([50, width - 50]);
            const y = d3.scaleLinear().domain([0, 100]).range([height - 50, 50]);

            const simulation = d3.forceSimulation(sample)
                .force("x", d3.forceX(d => x(d.album_release_date)).strength(1))
                .force("y", d3.forceY(d => y(d.artist_popularity)).strength(0.15))
                .force("collide", d3.forceCollide(6))
                .stop();

            for (let i = 0; i < 120; ++i) simulation.tick();

            svg.selectAll("circle")
                .data(sample)
                .join("circle")
                .attr("cx", d => d.x)
                .attr("cy", d => d.y)
                .attr("r", 4.5)
                .attr("fill", d => d.explicit ? "#e91e63" : "#2196f3")
                .attr("opacity", 0.7)
                .on("mouseover", (event, d) => {
                    tooltip.style("opacity", 1)
                        .html(`<strong>${d.track_name}</strong>${d.artist_name}<br>${d.explicit ? "Explicit" : "Clean"}`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", () => tooltip.style("opacity", 0));
            
            // Axes
            svg.append("g").attr("transform", `translate(0,${height - 30})`)
               .call(d3.axisBottom(x).ticks(5).tickFormat(d3.timeFormat("%Y")));
        }

        // --- 5. STREAMGRAPH (GENRE) ---
        function drawStreamgraph(data) {
            const container = d3.select("#viz-stream");
            const genreCounts = {};
            const allGenres = new Set();

            data.forEach(d => {
                if (!d.year || isNaN(d.year)) return;
                if (!genreCounts[d.year]) genreCounts[d.year] = {};
                let genres = d.artist_genres.replace(/['"\[\]]/g, '').split(',').map(s => s.trim());
                genres.forEach(g => {
                    if (g && g !== 'N/A') {
                        genreCounts[d.year][g] = (genreCounts[d.year][g] || 0) + 1;
                        allGenres.add(g);
                    }
                });
            });

            const genreTotals = Array.from(allGenres).map(g => {
                let sum = 0;
                for (let y in genreCounts) sum += (genreCounts[y][g] || 0);
                return { genre: g, count: sum };
            }).sort((a,b) => b.count - a.count).slice(0, 7); // Top 7
            
            const topGenres = genreTotals.map(d => d.genre);
            const years = Object.keys(genreCounts).sort((a,b) => a-b);
            const stackData = years.map(year => {
                const obj = { year: new Date(year, 0, 1) };
                topGenres.forEach(g => { obj[g] = genreCounts[year][g] || 0; });
                return obj;
            });

            const series = d3.stack().keys(topGenres).offset(d3.stackOffsetSilhouette)(stackData);
            const svg = container.append("svg").attr("viewBox", [0, 0, width, height]);

            const x = d3.scaleTime().domain(d3.extent(stackData, d => d.year)).range([0, width]);
            const y = d3.scaleLinear().domain([d3.min(series.flat(2)), d3.max(series.flat(2))]).range([height - 50, 50]);
            const color = d3.scaleOrdinal().domain(topGenres).range(["#1DB954", "#2196f3", "#9c27b0", "#ff9800", "#e91e63", "#00bcd4", "#D4AF37"]);

            svg.selectAll("path")
                .data(series)
                .join("path")
                .attr("fill", d => color(d.key))
                .attr("d", d3.area().curve(d3.curveBasis).x(d => x(d.data.year)).y0(d => y(d[0])).y1(d => y(d[1])))
                .attr("opacity", 0.8)
                .on("mouseover", function(event, d) {
                    d3.select(this).attr("opacity", 1);
                    tooltip.style("opacity", 1)
                        .html(`<strong>Genre: ${d.key}</strong>`)
                        .style("left", (event.pageX + 10) + "px")
                        .style("top", (event.pageY - 28) + "px");
                })
                .on("mouseout", function() {
                    d3.select(this).attr("opacity", 0.8);
                    tooltip.style("opacity", 0);
                });

             svg.append("g").attr("transform", `translate(0,${height - 30})`).call(d3.axisBottom(x).ticks(width / 80));
        }

    </script>
</body>
</html>
